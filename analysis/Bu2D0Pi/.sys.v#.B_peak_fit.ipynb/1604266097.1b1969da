{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Welcome to JupyROOT 6.20/06\n"
     ]
    }
   ],
   "source": [
    "import sys,os\n",
    "import uproot4 as uproot\n",
    "import awkward1 as ak\n",
    "import json\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from fcc_python_tools.locations import loc\n",
    "from fcc_python_tools import kinematics_flat\n",
    "from particle import literals as lp\n",
    "from fcc_python_tools import plotting\n",
    "import tensorflow as tf\n",
    "import zfit\n",
    "import random\n",
    "import ROOT\n",
    "\n",
    "from matplotlib import rc\n",
    "rc('font',**{'family':'serif','serif':['Roman']})\n",
    "rc('text', usetex=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "path = loc.FLAT + '/p8_ee_Zbb_ecm91_EvtGen_Bu2D0Pi.root'\n",
    "file = uproot.open(path)\n",
    "tree = file['events']\n",
    "\n",
    "events = tree.arrays(library=\"ak\", how=\"zip\")\n",
    "\n",
    "#Number of events to keep and analyse\n",
    "n_events = 100000\n",
    "\n",
    "#Container for the reco particles\n",
    "p_c = 'rec_part'\n",
    "p = events[p_c][:n_events]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "p[\"p\"] = kinematics_flat.calc_p(p)\n",
    "p_cut = p[\"p\"] > 1.\n",
    "p = p[p_cut]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "pi_cut = abs(p[\"mass\"] - lp.pi_plus.mass/1000.) < 1e-4\n",
    "pi = p[pi_cut]\n",
    "\n",
    "k_cut = abs(p[\"mass\"] - lp.K_plus.mass/1000.) < 1e-4\n",
    "k = p[k_cut]\n",
    "\n",
    "D = ak.cartesian({\"k\": k, \"pi\": pi})\n",
    "D_cut = np.sign(D[\"k\",\"charge\"]) != np.sign(D[\"pi\",\"charge\"])\n",
    "D = D[D_cut]\n",
    "\n",
    "PDG_K_m = lp.K_plus.mass/1000.\n",
    "PDG_pi_m = lp.pi_plus.mass/1000.\n",
    "D[\"mass\"] = kinematics_flat.mass([D[\"k\"], D[\"pi\"]], [PDG_K_m, PDG_pi_m])\n",
    "\n",
    "PDG_D_m = lp.D_0.mass/1000.\n",
    "D_window = 0.05\n",
    "D_cut = abs(D[\"mass\"] - PDG_D_m) < D_window\n",
    "D = D[D_cut]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "B = ak.cartesian({\"D_k\": D[\"k\"], \"D_pi\": D[\"pi\"], \"pi\": pi})\n",
    "B_cut = np.sign(B[\"D_k\",\"charge\"]) == np.sign(B[\"pi\",\"charge\"])\n",
    "B = B[B_cut]\n",
    "B[\"mass\"] = kinematics_flat.mass([B[\"D_k\"], B[\"D_pi\"], B[\"pi\"]], [PDG_K_m, PDG_pi_m, PDG_pi_m])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "low = 5.22\n",
    "high = 5.34\n",
    "B_cut = np.logical_and(B[\"mass\"] > low, B[\"mass\"] < high)\n",
    "B = B[B_cut]\n",
    "\n",
    "plotting.errorbar_hist(B,\"mass\",\"B\",\"$m([K^\\pm \\pi^\\mp]_D \\pi^\\pm)$\",\"GeV/$c^2$\",low,high,100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "obs = zfit.Space('mB', limits=(low, high))\n",
    "\n",
    "#Signal PDF\n",
    "B_mu = zfit.Parameter(\"B_mu\", 5.279, low, high)\n",
    "B_sigma = zfit.Parameter(\"B_sigma\", 0.005, 0., 0.1)\n",
    "B_alphaL = zfit.Parameter(\"B_alphaL\", 0.2, 0., 5.)\n",
    "B_nL = zfit.Parameter(\"B_nL\", 0.1, 0., 200.)\n",
    "B_alphaR = zfit.Parameter(\"B_alphaR\", -0.2, -5., 0.)\n",
    "B_nR = zfit.Parameter(\"B_nR\", 0.1, 0., 200.)\n",
    "frac = zfit.Parameter(\"frac\", 0.5, 0., 1.)\n",
    "\n",
    "n_sig = zfit.Parameter(\"n_sig\", 9000, 0., 20000.)\n",
    "\n",
    "pdf_sigL = zfit.pdf.CrystalBall(obs=obs, mu=B_mu, sigma=B_sigma, alpha=B_alphaL, n=B_nL)\n",
    "pdf_sigR = zfit.pdf.CrystalBall(obs=obs, mu=B_mu, sigma=B_sigma, alpha=B_alphaR, n=B_nR)\n",
    "pdf_sig = zfit.pdf.SumPDF([pdf_sigL, pdf_sigR], frac).create_extended(n_sig)\n",
    "\n",
    "#Background PDF\n",
    "comb = zfit.Parameter(\"comb\", -0.1, -1, 1.)\n",
    "\n",
    "n_bkg = zfit.Parameter(\"n_bkg\", 1000., 0., 10000.)\n",
    "\n",
    "pdf_bkg = zfit.pdf.Chebyshev(obs=obs, coeffs=[comb]).create_extended(n_bkg)\n",
    "\n",
    "#Total PDF\n",
    "pdf = zfit.pdf.SumPDF([pdf_sig, pdf_bkg])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_np = ak.to_numpy(ak.flatten(B[\"mass\"]))\n",
    "data = zfit.Data.from_numpy(obs=obs, array=data_np)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/eos/user/d/dhill/.local/lib/python3.7/site-packages/zfit/models/polynomials.py:27: UserWarning: The function <function Space.limit1d at 0x7f9ee5d667a0> may does not return the actual area/limits but rather the rectangular limits. <zfit Space obs=('mB',), axes=(0,), limits=(array([[5.22]]), array([[5.34]]))> can also have functional limits that are arbitrarily defined and lay inside the rect_limits. To test if a value is inside, use `inside` or `filter`.\n",
      "  lim_low, lim_high = limits.limit1d\n",
      "/eos/user/d/dhill/.local/lib/python3.7/site-packages/zfit/models/polynomials.py:276: UserWarning: The function <function Space.area at 0x7f9ee5d66560> may does not return the actual area/limits but rather the rectangular limits. <zfit Space obs=('mB',), axes=(0,), limits=(array([[5.22]]), array([[5.34]]))> can also have functional limits that are arbitrarily defined and lay inside the rect_limits. To test if a value is inside, use `inside` or `filter`.\n",
      "  integral *= 0.5 * model.space.area()  # rescale back to whole width\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "┌──────────────────────────────────┬──────────────────────────────────────┐\n",
      "│ FCN = -1.021e+06                 │       Ncalls = 971 (971 total)       │\n",
      "│ EDM = 4.52e-05 (Goal: 1e-05)     │               up = 0.5               │\n",
      "├───────────────┬──────────────────┼──────────────────────────────────────┤\n",
      "│ Valid Minimum │ Valid Parameters │       SOME Parameters at limit       │\n",
      "├───────────────┴──────────────────┼──────────────────────────────────────┤\n",
      "│ Below EDM threshold (goal x 10)  │           Below call limit           │\n",
      "├───────────────┬──────────────────┼───────────┬─────────────┬────────────┤\n",
      "│   Hesse ok    │  Has Covariance  │APPROXIMATE│NOT pos. def.│   FORCED   │\n",
      "└───────────────┴──────────────────┴───────────┴─────────────┴────────────┘\n"
     ]
    }
   ],
   "source": [
    "nll = zfit.loss.ExtendedUnbinnedNLL(model=pdf, data=data)\n",
    "minimizer = zfit.minimize.Minuit(tolerance=1e-5)\n",
    "result = minimizer.minimize(nll)\n",
    "param_errors, _ = result.errors(method=\"minuit_minos\")\n",
    "\n",
    "print(\"m(B) fit function minimum:\", result.fmin)\n",
    "print(\"m(B) fit converged:\", result.converged)\n",
    "print(\"m(B) fit full minimizer information:\", result.info)\n",
    "\n",
    "params = result.params\n",
    "print(params)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
