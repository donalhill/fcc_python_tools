{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sys,os\n",
    "import uproot4 as uproot\n",
    "import awkward1 as ak\n",
    "import json\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from fcc_python_tools.locations import loc\n",
    "from fcc_python_tools import kinematics_flat\n",
    "from particle import literals as lp\n",
    "from fcc_python_tools import plotting\n",
    "import tensorflow as tf\n",
    "import zfit\n",
    "import random\n",
    "\n",
    "from matplotlib import rc\n",
    "rc('font',**{'family':'serif','serif':['Roman']})\n",
    "rc('text', usetex=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "mode = \"Bu2D0Pi\"\n",
    "path = loc.FLAT + f'/p8_ee_Zbb_ecm91_EvtGen_{mode}.root'\n",
    "file = uproot.open(path)\n",
    "tree = file['events']\n",
    "\n",
    "events = tree.arrays(library=\"ak\", how=\"zip\")\n",
    "\n",
    "#Number of events to keep and analyse\n",
    "n_events = 10000\n",
    "\n",
    "#Container for the reco particles\n",
    "p_c = 'rec_part'\n",
    "p = events[p_c][:n_events]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "p[\"p\"] = kinematics_flat.calc_p(p)\n",
    "p_cut = p[\"p\"] > 1.\n",
    "p = p[p_cut]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "pi_cut = abs(p[\"mass\"] - lp.pi_plus.mass/1000.) < 1e-4\n",
    "pi = p[pi_cut]\n",
    "\n",
    "k_cut = abs(p[\"mass\"] - lp.K_plus.mass/1000.) < 1e-4\n",
    "k = p[k_cut]\n",
    "\n",
    "D = ak.cartesian({\"k\": k, \"pi\": pi})\n",
    "D_cut = np.sign(D[\"k\",\"charge\"]) != np.sign(D[\"pi\",\"charge\"])\n",
    "D = D[D_cut]\n",
    "\n",
    "PDG_K_m = lp.K_plus.mass/1000.\n",
    "PDG_pi_m = lp.pi_plus.mass/1000.\n",
    "D[\"mass\"] = kinematics_flat.mass([D[\"k\"], D[\"pi\"]], [PDG_K_m, PDG_pi_m])\n",
    "\n",
    "PDG_D_m = lp.D_0.mass/1000.\n",
    "D_window = 0.05\n",
    "D_cut = abs(D[\"mass\"] - PDG_D_m) < D_window\n",
    "D = D[D_cut]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "B = ak.cartesian({\"D_k\": D[\"k\"], \"D_pi\": D[\"pi\"], \"pi\": pi})\n",
    "B_cut = np.sign(B[\"D_k\",\"charge\"]) == np.sign(B[\"pi\",\"charge\"])\n",
    "B = B[B_cut]\n",
    "B[\"mass\"] = kinematics_flat.mass([B[\"D_k\"], B[\"D_pi\"], B[\"pi\"]], [PDG_K_m, PDG_pi_m, PDG_pi_m])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "low = 5.22\n",
    "high = 5.34\n",
    "B_cut = np.logical_and(B[\"mass\"] > low, B[\"mass\"] < high)\n",
    "B = B[B_cut]\n",
    "\n",
    "plotting.errorbar_hist(B,\"mass\",\"B\",\"$m([K^\\pm \\pi^\\mp]_D \\pi^\\pm)$\",\"GeV/$c^2$\",low,high,100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "obs = zfit.Space('mB', limits=(low, high))\n",
    "\n",
    "#Signal PDF\n",
    "rand = random.randint(0,999)\n",
    "B_mu = zfit.Parameter(f\"B_mu_{rand}\", 5.279, low, high)\n",
    "B_sigma = zfit.Parameter(f\"B_sigma_{rand}\", 0.0055, 0., 0.1)\n",
    "B_alphaL = zfit.Parameter(f\"B_alphaL_{rand}\", 0.2, 0., 5.)\n",
    "B_nL = zfit.Parameter(f\"B_nL_{rand}\", 100., 0., 200.)\n",
    "B_alphaR = zfit.Parameter(f\"B_alphaR_{rand}\", -0.2, -5., 0.)\n",
    "B_nR = zfit.Parameter(f\"B_nR_{rand}\", 100., 0., 200.)\n",
    "frac = zfit.Parameter(f\"frac_{rand}\", 0.5, 0., 1.)\n",
    "\n",
    "n_sig = zfit.Parameter(f\"n_sig_{rand}\",8000., 0., 20000.)\n",
    "\n",
    "pdf_sigL = zfit.pdf.CrystalBall(obs=obs, mu=B_mu, sigma=B_sigma, alpha=B_alphaL, n=B_nL)\n",
    "pdf_sigR = zfit.pdf.CrystalBall(obs=obs, mu=B_mu, sigma=B_sigma, alpha=B_alphaR, n=B_nR)\n",
    "pdf_sig = zfit.pdf.SumPDF([pdf_sigL, pdf_sigR], frac).create_extended(n_sig)\n",
    "\n",
    "#Background PDF\n",
    "comb = zfit.Parameter(f\"comb_{rand}\", -0.1, -1, 1.)\n",
    "\n",
    "n_bkg = zfit.Parameter(f\"n_bkg_{rand}\", 1000., 0., 10000.)\n",
    "\n",
    "pdf_bkg = zfit.pdf.Chebyshev(obs=obs, coeffs=[comb]).create_extended(n_bkg)\n",
    "\n",
    "#Total PDF\n",
    "pdf = zfit.pdf.SumPDF([pdf_sig, pdf_bkg])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_np = ak.to_numpy(ak.flatten(B[\"mass\"]))\n",
    "data = zfit.Data.from_numpy(obs=obs, array=data_np)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "┌──────────────────────────────────┬──────────────────────────────────────┐\n",
      "│ FCN = -8.712e+04                 │       Ncalls = 965 (965 total)       │\n",
      "│ EDM = 5.88e-06 (Goal: 1e-05)     │               up = 0.5               │\n",
      "├───────────────┬──────────────────┼──────────────────────────────────────┤\n",
      "│ Valid Minimum │ Valid Parameters │        No Parameters at limit        │\n",
      "├───────────────┴──────────────────┼──────────────────────────────────────┤\n",
      "│ Below EDM threshold (goal x 10)  │           Below call limit           │\n",
      "├───────────────┬──────────────────┼───────────┬─────────────┬────────────┤\n",
      "│   Hesse ok    │  Has Covariance  │ Accurate  │  Pos. def.  │ Not forced │\n",
      "└───────────────┴──────────────────┴───────────┴─────────────┴────────────┘\n",
      "m(B) fit function minimum: -87122.43754647025\n",
      "m(B) fit converged: True\n",
      "m(B) fit full minimizer information: {'n_eval': 965, 'n_iter': 965, 'original': FMin(fval=-87122.43754647025, edm=5.87895049046159e-06, tolerance=0.01, nfcn=965, ncalls=965, up=0.5, is_valid=True, has_valid_parameters=True, has_accurate_covar=True, has_posdef_covar=True, has_made_posdef_covar=False, hesse_failed=False, has_covariance=True, is_above_max_edm=False, has_reached_call_limit=False, has_parameters_at_limit=False)}\n",
      "name            value         minuit_minos    at limit\n",
      "-----------  --------  -------------------  ----------\n",
      "n_sig_16         7649  -     97   +     98       False\n",
      "n_bkg_16        222.2  -     45   +     48       False\n",
      "frac_16        0.5389  -  0.039   +  0.039       False\n",
      "B_alphaL_16    0.6178  -  0.039   +  0.038       False\n",
      "B_mu_16         5.279  -0.00012   +0.00012       False\n",
      "B_nL_16         101.4  -   0.37   +   0.37       False\n",
      "B_sigma_16   0.005601  -0.00017   +0.00018       False\n",
      "B_alphaR_16   -0.5453  -  0.042   +  0.043       False\n",
      "B_nR_16          42.8  -     26   +    3.5       False\n",
      "comb_16      -0.03983  -   0.26   +   0.26       False\n"
     ]
    }
   ],
   "source": [
    "nll = zfit.loss.ExtendedUnbinnedNLL(model=pdf, data=data)\n",
    "minimizer = zfit.minimize.Minuit(tolerance=1e-5)\n",
    "result = minimizer.minimize(nll)\n",
    "param_errors, _ = result.errors(method=\"minuit_minos\")\n",
    "\n",
    "print(\"m(B) fit function minimum:\", result.fmin)\n",
    "print(\"m(B) fit converged:\", result.converged)\n",
    "print(\"m(B) fit full minimizer information:\", result.info)\n",
    "\n",
    "params = result.params\n",
    "print(params)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/bin/start_ipykernel.py:2: UserWarning: The function <function Space.limits at 0x7f01714390e0> may does not return the actual area/limits but rather the rectangular limits. <zfit Space obs=('mB',), axes=None, limits=(array([[5.22]]), array([[5.34]]))> can also have functional limits that are arbitrarily defined and lay inside the rect_limits. To test if a value is inside, use `inside` or `filter`.\n",
      "  if __name__ == '__main__':\n"
     ]
    }
   ],
   "source": [
    "fig,ax = plt.subplots(figsize=(8,8))\n",
    "lower, upper = obs.limits\n",
    "low = lower[-1][0]\n",
    "high = upper[0][0]\n",
    "bin_width = 0.002\n",
    "bins = int(float(high - low)/bin_width)\n",
    "counts, bin_edges = np.histogram(data_np, bins, range=(low,high))\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2.\n",
    "err = np.sqrt(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', markersize=3, color='black')\n",
    "x_plot = np.linspace(low, high, num=1000)\n",
    "y_plot_tot = zfit.run(pdf.pdf(x_plot, norm_range=obs))\n",
    "plt.plot(x_plot, y_plot_tot*len(data_np)/bins*obs.area(), color='navy', linewidth=2.5, alpha=0.6)\n",
    "y_plot_sig = zfit.run(pdf_sig.pdf(x_plot, norm_range=obs))\n",
    "plt.plot(x_plot,y_plot_sig*params[n_sig]['value']/bins*obs.area(), color='crimson')\n",
    "y_plot_bkg = zfit.run(pdf_bkg.pdf(x_plot, norm_range=obs))\n",
    "plt.plot(x_plot,y_plot_bkg*params[n_bkg]['value']/bins*obs.area(), color='forestgreen', linestyle='dashed')\n",
    "ax.tick_params(axis='both', which='major', labelsize=25)\n",
    "plt.ylabel(\"Candidates / (%.3f GeV/$c^2$)\" % bin_width,fontsize=25)\n",
    "plt.xlabel(\"$m([K^\\pm \\pi^\\mp]_D \\pi^\\pm)$ [GeV/$c^2$]\",fontsize=25)\n",
    "plt.xlim(low,high)\n",
    "ymin, ymax = plt.ylim()\n",
    "plt.ylim(0,1.05*ymax)\n",
    "plt.tight_layout()\n",
    "fig.savefig(loc.PLOTS+f\"/{mode}_B_M_fit.pdf\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
